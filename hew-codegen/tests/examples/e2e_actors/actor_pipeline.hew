// Test: Actor Pipeline
// Exercises: Chain of actors transforming data
actor Doubler {
    let id: int;
    receive fn process(n: int) {
        let result = n * 2;
        print("Doubler: ");
        print(n);
        println(f" -> {result}");
    }
}

actor Adder {
    let offset: int;
    receive fn process(n: int) {
        let result = n + self.offset;
        print("Adder(+");
        print(self.offset);
        print("): ");
        print(n);
        println(f" -> {result}");
    }
}

fn main() {
    println("=== Actor Pipeline ===");
    let doubler = spawn Doubler(target: 1);
    let adder = spawn Adder(base: 10);
    // Process values through the pipeline with sleeps for ordering
    doubler.process(5);
    sleep_ms(50);
    adder.process(5);
    sleep_ms(50);
    doubler.process(10);
    sleep_ms(50);
    adder.process(10);
    sleep_ms(50);
    doubler.process(25);
    sleep_ms(50);
    adder.process(25);
    sleep_ms(200);
    println("Done");
}
