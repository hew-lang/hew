type Resource {
    id: int;
}

impl Drop for Resource {
    fn drop(self: Resource) {
        print("drop ");
        println(self.id);
    }
}

fn main() -> int {
    // Test 1: droppable in if-branch
    println("test1");
    if true {
        let r = Resource { id: 1 };
        println("in if");
    }
    println("after if");

    // Test 2: droppable in loop body with break
    println("test2");
    var i: int = 0;
    while i < 3 {
        let r = Resource { id: 20 + i };
        if i == 1 {
            break;
        }
        i = (i + 1) as int;
    }
    println("after break");

    // Test 3: droppable in loop body with continue
    println("test3");
    var j: int = 0;
    while j < 3 {
        let r = Resource { id: 30 + j };
        j = (j + 1) as int;
        if j == 2 {
            continue;
        }
        println(j);
    }
    println("after loop");
    return 0;
}
