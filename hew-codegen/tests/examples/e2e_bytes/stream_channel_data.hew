import std::stream;

fn main() {
    let (sink, input) = stream.channel(8);

    sink.write("hello");
    sink.write("world");
    sink.write("!");
    sink.close();

    var count: int = 0;
    for await item in input {
        println(item);
        count = (count + 1) as int;
    }
    println(count);
    input.close();
}
