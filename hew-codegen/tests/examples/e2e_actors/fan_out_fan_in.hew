// Test: Fan-Out Fan-In (MapReduce pattern)
// Exercises: Multiple worker actors processing in parallel
actor Worker {
    let id: int;
    receive fn compute(n: int) {
        let result = n * n;
        print("Worker ");
        print(self.id);
        print(": ");
        print(n);
        println(f"^2 = {result}");
    }
}

fn main() {
    println("=== Fan Out Fan In ===");
    let w1 = spawn Worker(id: 1);
    let w2 = spawn Worker(id: 2);
    let w3 = spawn Worker(id: 3);
    // Distribute work with sleeps for deterministic ordering
    w1.compute(2);
    sleep_ms(50);
    w2.compute(3);
    sleep_ms(50);
    w3.compute(4);
    sleep_ms(50);
    w1.compute(5);
    sleep_ms(50);
    w2.compute(6);
    sleep_ms(50);
    w3.compute(7);
    sleep_ms(300);
    println("Done");
}
