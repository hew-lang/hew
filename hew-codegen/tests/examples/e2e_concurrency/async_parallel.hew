// Test: Parallel Computation via Actors
// Exercises: Multiple actors computing independently
// NOTE: async/await has a known codegen issue; this tests parallelism via actors
actor Computer {
    let id: int;
    receive fn square(n: int) {
        let result = n * n;
        print("compute ");
        print(n);
        println(f"^2 = {result}");
    }
}

fn square(n: int) -> int {
    n * n
}

fn main() -> int {
    println("=== Parallel Computation ===");

    // Compute in parallel via actors
    let c1 = spawn Computer(id: 1);
    let c2 = spawn Computer(id: 2);
    let c3 = spawn Computer(id: 3);
    c1.square(3);
    sleep_ms(50);
    c2.square(4);
    sleep_ms(50);
    c3.square(5);
    sleep_ms(200);

    // Verify results synchronously
    let r1 = square(3);
    let r2 = square(4);
    let r3 = square(5);
    let sum = r1 + r2 + r3;
    println(f"Sum = {sum}");
    if sum == 50 {
        println("PASS");
        0
    } else {
        println("FAIL");
        1
    }
}
